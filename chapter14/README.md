## 📍 14장 점진적인 개선

> 명령행 인수 구문분석기 사례 연구

#### 명령행? 프롬프르타 뜨고 커서가 사용자 입력을 기다리고 있는 행

#### 명령행 인수란? 

 - ##### Args (Argument Count)

   	- 명령행 개수
   	- ex) 프롬프트에 1을 입력했을 경우 Args = 1, 1 2를 입력했을 경우 Args = 2

- ##### Argv (Argument Vector)

  - 명령행 메모리 목록 (배열)
  - ex) abc일 때, argv[0] [0]은 a, argv[0] [1]은 b이다.



[출처: main()함수의 인자 활용](https://yyman.tistory.com/147)

</br>



--------

</br>





- ### 명령행 인수 구문 분석하는 방법

  > Args 생성자에 입력으로 들어온 인수 문자열과 형식 문자열을 넘겨 Args 인스턴스를 생성한 후 Args 인스턴스에다 인수 값을 질의한다.

#### 

</br>



----



</br>



- ### Args 구현

  > 이름을 붙인 방법, 함수 크기, 코드 형식에 주의하며 코드를 짠다.
  >
  > 날짜 인수나 복소수 인수 등 새로운 인수 유형을 추가하는 방법이 명백하다.

  

  </br>

  

  - #### 어떻게 짰느냐고?

    > 깨끗한 코드를 짜려면 먼저 지저분한 코드를 짠 뒤에 정리해야 한다. 
    >
    > 1차 초안, 2차 초안 등을 계속 고쳐 최종안을 만든다.



</br>



----



</br>



- ### Args: 1차 초안

  > 코드는 돌아가지만 엉망인 상태
  >
  > 인스턴스의 개수가 많음.
  >
  > 초가할 인수 유형이 늘어남에 따라 코드가 엉망이 됨
  >
  > 

  

  </br>

  

  - #### 그래서 멈췄다

    > 기능을 추가하지 않고 리팩터링
    >
    > 새 인수 유형을 추가하려면 주요 지점 세곳에다가 코드를 추가해야한다는 사실을 인지
    >
    > => 인수 유형은 다양하지만 모두가 유사한 메서드를 제공하므로 클래스 하나가 적합하다고 판단
    >
    > => ArgumentMarshaler 생성

  

  </br>

  

  - #### 점진적으로 개선하다

    > 프로그램을 망치는 가장 중요한 방법 중 하나는 개선이라는 이름 아래 구조를 크게 뒤집는 행위이다. => TDD 기법을 사용하여 코드 개선

    ###### TDD: 언제 어느 때라도 시스템이 돌아가야 한다는 원칙. 시스템을 망가뜨리는 변경을 허용하지 않는다. 

    

    </br>



-----



</br>



- #### String 인수

  > String 인수를 추가하기 위해 HashMap을 변경한 후 parse, get, set 함수 수정
  >
  > 이 때, 저자는 모든 논리를 ArgumentMarshaler 클래스에 곧바로 넣음.
  >
  > 이유) 각 인수 유형을 처리하는 코드를 모두 ArgumentMarshaler 클래스에 넣고 ArgumentMarshaler 파생 클래스를 만들어 코드를 분리하기 위해

  

</br>



----



</br>



- ### 결론

  > 나쁜 코드보다 더 오랫똥안 더 심각하게 개발 프로젝트에 악영향을 미치는 요인도 없다. 
  >
  > 개선하는 것은 비용이 많이 들지만, 처음부터 코드를 개끗하게 유지하기란 상대적으로 쉽다.
  >
  > 그러므로 코드는 언제나 최대한 깔끔하고 단순하게 정리하자.



</br>



----



</br>



- ### 느낀 점

  > 이 챕터는 처음으로 리팩터링 하는 과정을 처음부터 끝까지 다루어 본 챕터이다. 하지만 나는 명령형 인수를 자주 사용하지 못하기에 명령형 인수의 개념을 잘 알지 못하였다. 그래서인지 명령형 인수에 대한 개념을 써내려가는 것 부터 많이 어려웠고, 이를 모두 이해를 했어도 바로 코드를 읽기란 쉽지 않았다. 그래도 이 챕터에서 최대한 꼼꼼히 세세하게 리팩터링 과정을 다룬 것 같아 어떠한 방식으로, 그리고 리팩터링 과정에서도 갈등이 생겼을 때 어떤 방법을 사용하여 대처할 수 있는지 알 수 있었다.  

